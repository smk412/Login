# spring-react-google-oauth2

Implementing Google OAuth2 login using Spring Boot and React.

The following diagram illustrates the OAuth implicit flow:

![oauthFlow](https://user-images.githubusercontent.com/55564829/172382434-48ed0c73-dadb-4b85-ab22-19d9e1b89033.png)

## Result

Demonstration of the Google OAuth login process:


![google-oauth-login](https://user-images.githubusercontent.com/55564829/172130755-ab1dc492-0686-407a-8d64-ba9816f941a4.gif)


# How to start

## Prerequiste

Before you begin, ensure you have created a Google OAuth credential.

Refer to this guide for assistance: [Google OAuth Credentials](https://docs.retool.com/data-sources/guides/authentication/google-oauth)

#### Important Note

While configuring 'Authorized JavaScript origins' in the Google Developer Console's Credential settings, remember to add both http://localhost and http://localhost:3000.

<img width="561" alt="스크린샷 2023-12-07 오후 2 25 27" src="https://github.com/baezzys/spring-react-google-oauth2/assets/55564829/284556b1-4c70-4c65-9384-df1e6dc37893">


## Spring boot

1. In application.yml, replace app: googleClientId with your Google client ID and app: jwtSecret with a secret string (minimum 256 bits for enhanced security).

```yaml
app:
  jwtSecret: "String longer than 256 bits"
  googleClientId: "your google client id"
```

2. Execute the following commands in the terminal:
```shell
cd spring-oauth

./gradlew build

cd build/libs

java -jar oauth-0.0.1-SNAPSHOT.jar
```

### Process Overview

1. Validate the ID token received from the client.
2. Create an account using the ID token information.
3. Store the account in the database using Spring Data JPA and H2.
4. Generate a custom JWT.
5. Send a cookie containing the custom JWT back to the client.
6. Include the JWT in the request header for API requests.
7. JWT filter validates the JWT in each client request header.

## REACT

1. Update REACT_APP_GOOGLE_CLIENT_ID in react-oauth/.env with your Google client ID.

```js
REACT_APP_API_URL="http://localhost:8080"
REACT_APP_GOOGLE_CLIENT_ID="your google client-id"
```

2. Run the following commands:
```shell
cd react-oauth

npm install

npm start
```

Note: If you encounter a version conflict during npm install, try npm install --force.

### Process Overview

1. Log in with an existing Google account.
2. Obtain an ID token from Google.
3. Send the ID token to the server for authentication.
4. Receive a cookie containing a JWT generated by the server.
5. Request user information from the server using the cookie.
6. Display the user information.


